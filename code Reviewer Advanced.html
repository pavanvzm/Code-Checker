<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Review Bot</title>
    <style>
        :root {
            /* Light mode variables */
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --text-primary: #333333;
            --text-secondary: #4a5568;
            --border-color: #e2e8f0;
            --header-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --panel-shadow: 0 2px 10px rgba(0,0,0,0.1);
            --issue-shadow: 0 1px 3px rgba(0,0,0,0.05);
            --stat-bg: #ffffff;
            --code-bg: #f8fafc;
            --issue-bg: #ffffff;
            --change-before-bg: #fed7d7;
            --change-after-bg: #c6f6d5;
            --suggestion-bg: #ebf8ff;
            --button-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --toggle-bg: #e2e8f0;
            --toggle-handle: #ffffff;
        }

        .dark-mode {
            /* Dark mode variables */
            --bg-primary: #1a202c;
            --bg-secondary: #2d3748;
            --text-primary: #e2e8f0;
            --text-secondary: #cbd5e0;
            --border-color: #4a5568;
            --header-bg: linear-gradient(135deg, #5a67d8 0%, #805ad5 100%);
            --panel-shadow: 0 4px 6px rgba(0,0,0,0.3);
            --issue-shadow: 0 1px 3px rgba(0,0,0,0.2);
            --stat-bg: #2d3748;
            --code-bg: #2d3748;
            --issue-bg: #2d3748;
            --change-before-bg: #742a2a;
            --change-after-bg: #22543d;
            --suggestion-bg: #2b6cb0;
            --button-bg: linear-gradient(135deg, #5a67d8 0%, #805ad5 100%);
            --toggle-bg: #4a5568;
            --toggle-handle: #e2e8f0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--header-bg);
            color: white;
            border-radius: 10px;
            box-shadow: var(--panel-shadow);
            position: relative;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--toggle-bg);
            border: none;
            border-radius: 20px;
            width: 60px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 2px;
            transition: background 0.3s;
        }

        .theme-toggle::before {
            content: '';
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: var(--toggle-handle);
            transition: transform 0.3s;
        }

        .dark-mode .theme-toggle::before {
            transform: translateX(30px);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: var(--bg-secondary);
            border-radius: 10px;
            box-shadow: var(--panel-shadow);
            padding: 20px;
            height: fit-content;
            transition: background 0.3s, box-shadow 0.3s;
        }

        .panel-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
        }

        textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            background-color: var(--code-bg);
            color: var(--text-primary);
            transition: border-color 0.3s, background 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        button {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .dark-mode button:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .results-panel {
            grid-column: span 2;
        }

        @media (max-width: 768px) {
            .results-panel {
                grid-column: span 1;
            }
        }

        .issues-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            background-color: var(--code-bg);
        }

        .issue {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            border-left: 4px solid #667eea;
            background: var(--issue-bg);
            box-shadow: var(--issue-shadow);
        }

        .issue.high {
            border-left-color: #e53e3e;
        }

        .issue.medium {
            border-left-color: #d69e2e;
        }

        .issue.low {
            border-left-color: #38a169;
        }

        .issue-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .issue-type {
            font-weight: 600;
            text-transform: capitalize;
        }

        .issue-location {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .issue-message {
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .issue-suggestion {
            background-color: var(--suggestion-bg);
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            border-left: 3px solid #4299e1;
        }

        .code-sample {
            background-color: var(--code-bg);
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 10px;
            white-space: pre-wrap;
        }

        .changes-section {
            margin-top: 20px;
        }

        .change {
            background-color: var(--issue-bg);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            border-left: 4px solid #38a169;
        }

        .change-header {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .change-before, .change-after {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
        }

        .change-before {
            background-color: var(--change-before-bg);
            color: #c53030;
        }

        .dark-mode .change-before {
            color: #feb2b2;
        }

        .change-after {
            background-color: var(--change-after-bg);
            color: #2f855a;
        }

        .dark-mode .change-after {
            color: #9ae6b4;
        }

        .corrected-code {
            background-color: var(--code-bg);
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid var(--border-color);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--stat-bg);
            padding: 15px;
            border-radius: 8px;
            box-shadow: var(--panel-shadow);
            flex: 1;
            min-width: 120px;
            text-align: center;
            transition: background 0.3s, box-shadow 0.3s;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .no-issues {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .no-issues i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
            color: #38a169;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🤖 Code Review Bot</h1>
            <p class="subtitle">Automated code analysis and correction tool</p>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode"></button>
        </header>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="total-issues">0</div>
                <div class="stat-label">Issues Found</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="high-issues">0</div>
                <div class="stat-label">High Severity</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="medium-issues">0</div>
                <div class="stat-label">Medium Severity</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="low-issues">0</div>
                <div class="stat-label">Low Severity</div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="panel">
                <h2 class="panel-title">📝 Input Code</h2>
                <textarea id="input-code" placeholder="Paste your Python code here..."># Paste your Python code here for review
import os

def process_data(data):
    global result
    result = eval(data)  # Dangerous!
    print("Processing complete")
    return result

try:
    process_data("1+1")
except:
    pass

x = 1; y = 2; z = 3  # Multiple statements

# TODO: Implement proper error handling
very_long_line = "This is a very long line that exceeds the recommended character limit and should be broken into multiple lines for better readability"</textarea>
                <div class="controls">
                    <button id="review-btn">🔍 Review Code</button>
                    <button id="fix-btn">🔧 Auto-Fix Issues</button>
                    <button id="clear-btn">🗑️ Clear</button>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title">📋 Corrected Code</h2>
                <textarea id="output-code" placeholder="Corrected code will appear here..."></textarea>
            </div>
            
            <div class="panel results-panel">
                <h2 class="panel-title">⚠️ Issues Found</h2>
                <div class="issues-list" id="issues-container">
                    <div class="no-issues">
                        <div>📋</div>
                        <h3>No issues to display</h3>
                        <p>Review your code to see analysis results</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        // Check for saved theme preference or respect OS preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            body.classList.add('dark-mode');
        }

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        // Code Review Bot Implementation
        class Issue {
            constructor(type, line, column, message, suggestion, codeSample, severity = "medium") {
                this.type = type;
                this.line = line;
                this.column = column;
                this.message = message;
                this.suggestion = suggestion;
                this.codeSample = codeSample;
                this.severity = severity;
            }
        }

        class CodeReviewBot {
            constructor() {
                this.autoFixes = {
                    'bare_except': this._fixBareExcept,
                    'print_statement': this._fixPrintStatement,
                    'long_line': this._fixLongLine,
                    'multiple_statements': this._fixMultipleStatements,
                    'eval_usage': this._fixEvalUsage
                };
            }

            reviewCode(code, autoFix = false) {
                const issues = [];
                const lines = code.split('\n');
                
                // Simple pattern-based checks
                lines.forEach((line, index) => {
                    const lineNum = index + 1;
                    
                    // Check for print statements
                    const printMatch = line.match(/\bprint\s*\(/);
                    if (printMatch) {
                        issues.push(new Issue(
                            'print_statement',
                            lineNum,
                            printMatch.index,
                            "Print statement found",
                            "Replace with logging or remove for production code",
                            line,
                            "low"
                        ));
                    }
                    
                    // Check for TODO comments
                    const todoMatch = line.match(/#\s*TODO/i);
                    if (todoMatch) {
                        issues.push(new Issue(
                            'todo_comment',
                            lineNum,
                            todoMatch.index,
                            "TODO comment found",
                            "Address TODO comments or create tracking issues",
                            line,
                            "low"
                        ));
                    }
                    
                    // Check for long lines
                    if (line.length > 100) {
                        issues.push(new Issue(
                            'long_line',
                            lineNum,
                            100,
                            `Line too long (${line.length} characters)`,
                            "Break long lines into multiple lines for better readability",
                            line,
                            "low"
                        ));
                    }
                    
                    // Check for multiple statements
                    const multiStmtMatch = line.match(/;\s*\w+/);
                    if (multiStmtMatch) {
                        issues.push(new Issue(
                            'multiple_statements',
                            lineNum,
                            multiStmtMatch.index,
                            "Multiple statements on one line",
                            "Use one statement per line for better readability",
                            line,
                            "low"
                        ));
                    }
                    
                    // Check for eval usage
                    const evalMatch = line.match(/\beval\s*\(/);
                    if (evalMatch) {
                        issues.push(new Issue(
                            'eval_usage',
                            lineNum,
                            evalMatch.index,
                            "Use of eval detected",
                            "Avoid eval for security reasons. Use safer alternatives.",
                            line,
                            "high"
                        ));
                    }
                    
                    // Check for bare except
                    const bareExceptMatch = line.match(/^\s*except\s*:/);
                    if (bareExceptMatch) {
                        issues.push(new Issue(
                            'bare_except',
                            lineNum,
                            bareExceptMatch.index,
                            "Bare except clause detected",
                            "Specify exception types to avoid catching unexpected errors",
                            line,
                            "medium"
                        ));
                    }
                });
                
                // Apply auto-fixes if requested
                let changesMade = [];
                let correctedCode = code;
                if (autoFix && issues.length > 0) {
                    [correctedCode, changesMade] = this._applyAutoFixes(code, issues);
                }
                
                return {
                    issues: issues,
                    correctedCode: correctedCode,
                    changesMade: changesMade
                };
            }

            _applyAutoFixes(code, issues) {
                let lines = code.split('\n');
                const changes = [];
                
                // Process issues in reverse order to maintain line numbers
                [...issues].reverse().forEach(issue => {
                    const fixFunc = this.autoFixes[issue.type];
                    if (fixFunc) {
                        const originalLine = lines[issue.line - 1];
                        const fixedLine = fixFunc(originalLine, issue);
                        if (fixedLine !== originalLine) {
                            lines[issue.line - 1] = fixedLine;
                            changes.push({
                                line: issue.line,
                                original: originalLine,
                                corrected: fixedLine,
                                reason: issue.message
                            });
                        }
                    }
                });
                
                return [lines.join('\n'), changes];
            }

            _fixBareExcept(line) {
                return line.replace(/except\s*:/, 'except Exception:');
            }

            _fixPrintStatement(line) {
                return line.replace(/\bprint\s*\(/, 'logger.info(');
            }

            _fixLongLine(line) {
                if (line.length > 100) {
                    const breakPoint = line.substring(0, 100).lastIndexOf(' ');
                    if (breakPoint > 50) {
                        return line.substring(0, breakPoint) + "\n    " + line.substring(breakPoint + 1);
                    }
                }
                return line;
            }

            _fixMultipleStatements(line) {
                return line.replace(/;\s*/g, ';\n');
            }

            _fixEvalUsage(line) {
                return line.replace(/eval\(/g, 'safe_eval(');
            }
        }

        // DOM Elements
        const inputCode = document.getElementById('input-code');
        const outputCode = document.getElementById('output-code');
        const reviewBtn = document.getElementById('review-btn');
        const fixBtn = document.getElementById('fix-btn');
        const clearBtn = document.getElementById('clear-btn');
        const issuesContainer = document.getElementById('issues-container');
        const totalIssuesEl = document.getElementById('total-issues');
        const highIssuesEl = document.getElementById('high-issues');
        const mediumIssuesEl = document.getElementById('medium-issues');
        const lowIssuesEl = document.getElementById('low-issues');

        // Initialize bot
        const bot = new CodeReviewBot();

        // Event Listeners
        reviewBtn.addEventListener('click', () => {
            const code = inputCode.value;
            if (!code.trim()) {
                alert('Please enter some code to review');
                return;
            }
            
            const result = bot.reviewCode(code, false);
            displayResults(result);
        });

        fixBtn.addEventListener('click', () => {
            const code = inputCode.value;
            if (!code.trim()) {
                alert('Please enter some code to review');
                return;
            }
            
            const result = bot.reviewCode(code, true);
            outputCode.value = result.correctedCode;
            displayResults(result);
        });

        clearBtn.addEventListener('click', () => {
            inputCode.value = '';
            outputCode.value = '';
            issuesContainer.innerHTML = `
                <div class="no-issues">
                    <div>📋</div>
                    <h3>No issues to display</h3>
                    <p>Review your code to see analysis results</p>
                </div>
            `;
            updateStats(0, 0, 0, 0);
        });

        // Display Results
        function displayResults(result) {
            const { issues, changesMade } = result;
            
            // Update stats
            const high = issues.filter(i => i.severity === 'high').length;
            const medium = issues.filter(i => i.severity === 'medium').length;
            const low = issues.filter(i => i.severity === 'low').length;
            updateStats(issues.length, high, medium, low);
            
            // Display issues
            if (issues.length === 0) {
                issuesContainer.innerHTML = `
                    <div class="no-issues">
                        <div>✅</div>
                        <h3>No issues found!</h3>
                        <p>Your code looks good!</p>
                    </div>
                `;
                return;
            }
            
            let issuesHTML = '';
            issues.forEach(issue => {
                issuesHTML += `
                    <div class="issue ${issue.severity}">
                        <div class="issue-header">
                            <span class="issue-type">${issue.type.replace('_', ' ')}</span>
                            <span class="issue-location">Line ${issue.line}, Col ${issue.column}</span>
                        </div>
                        <div class="issue-message">${issue.message}</div>
                        <div class="issue-suggestion">${issue.suggestion}</div>
                        <div class="code-sample">${escapeHtml(issue.codeSample)}</div>
                    </div>
                `;
            });
            
            // Display changes if any
            if (changesMade.length > 0) {
                issuesHTML += `<div class="changes-section"><h3>🔧 Auto-corrections Applied</h3>`;
                changesMade.forEach(change => {
                    issuesHTML += `
                        <div class="change">
                            <div class="change-header">Line ${change.line}: ${change.reason}</div>
                            <div class="change-before">-${escapeHtml(change.original)}</div>
                            <div class="change-after">+${escapeHtml(change.corrected)}</div>
                        </div>
                    `;
                });
                issuesHTML += `</div>`;
            }
            
            issuesContainer.innerHTML = issuesHTML;
        }

        function updateStats(total, high, medium, low) {
            totalIssuesEl.textContent = total;
            highIssuesEl.textContent = high;
            mediumIssuesEl.textContent = medium;
            lowIssuesEl.textContent = low;
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "<")
                .replace(/>/g, ">")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Initialize with sample review
        window.addEventListener('DOMContentLoaded', () => {
            reviewBtn.click();
        });
    </script>
</body>
</html>